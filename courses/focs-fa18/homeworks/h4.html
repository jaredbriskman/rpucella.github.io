<!DOCTYPE html>
<html>

  <head>
    
    <meta charset="utf-8">
    <title>Homework 4</title>

    <link rel="stylesheet" href="../alt.css" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,800,700' rel='stylesheet' type='text/css'>

    <script src="autoscroll.js"></script>
    
    <style>

      hr { margin-top: 50px; }

        code,tt,pre {
          font-size: 110%;
        }
	
        div.lect {
	  padding-top: 0;
       	  padding-left: 3em;
	  margin-top:0;
        }
    	p.ann { 
    	  padding-left: 3em;
    	  text-indent: -3em; 
    	}
	p.ann_ctd{
	  padding-left: 3em;
        }
    	span.hdr {
   	  padding-right: 1em
    	}

	.hidden {
	  visibility: hidden;
        }

        tt.code {
           font-weight: bold;
        }

      div.code {
      border: 1px solid #c6c6c6;
      border-radius: 5px;
      padding: 0px;
      margin-bottom: 20px;
      }
      
      div.code p {
      margin:0px;
      padding:5px 10px;
      background:#eeeeee;
      font-style: italic;
      cursor:pointer;
      }

      div.code p:hover {
      background:#cccccc;
      }

      div.code pre { 
      display:none;
      padding: 10px;
      font-size:100%;
      }

      div.code.visible pre  {
      display:block;
      }

ol.question {
    padding-top:1em;
    list-style-type: decimal;
}

ol.subquestion {
    list-style-type: upper-alpha;
}

      ol.question > li {
      font-weight: bold;
      }

      ol.question > li > * {
      font-weight: normal;
      }
      
ol > li {
    padding:4px 8px; /* Add some spacing around the content */
}

li ol,
li ul {margin-top:6px;}

      li > p { margin-top:0;}


      table.diagram {
      border-collapse: collapse;
      }

      table.diagram td, table.diagram th {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
      }

      table.diagram th {
    text-align: center;
    background-color: #666;
    color: white;
      }

      
    </style>

    <script>
      function toggleShowHide (p) { 
      var div = p.parentNode;
        if (div.className && div.className.startsWith("visible")) {
          div.className = "code";
      } else {
        div.className = "visible code";
      }
      }
    </script>


  </head>


  <body>

    <div class="navbar">

      <div class="home">
	<a href="../../../index.html"><img src="../../../home.png" style="height: 1.6em;"></a>
      </div>

      <ul>
	<li><a href="../index.html"><b>Foundations of Computer Science FA18</b></a></li> 
	<li class="hidden"><a class="scrollto" href="#announcements">Announcements</a></li>
	<li class="hidden"><a class="scrollto" href="#info">Course Info</a></li>
	<li class="hidden"><a class="scrollto" href="#lectures">Lectures</a></li>
	<li class="hidden"><a class="scrollto" href="#homeworks">Homeworks</a></li>
      </ul>
    </div>


    <!-- padding -->
    <div id="top" style="height: 5em;"></div>
    
    <h1 class="clear">Homework 4</h1>
    
    <p class="subtitle">Due date: Thursday, Oct 4 (23h59)</p>

    <ul>
      <li><p>This homework is to be done
    individually. You may discuss problems with fellow students, but
    all submitted work must be entirely your own, and should not be from any
    other course, present, past, or future. If you use a solution from
    another source you must cite it &mdash; this includes when that source
	is someone else helping you.</p></li>
      <li><p><b>Please do not post your solutions on a public website or a public repository like GitHub.</b></p></li>

      <li><p>All programming is to be done in OCaml v4.</p></li>

      <li><p>Code your answers by modifying the
      file <a href="homework4.ml"><tt>homework4.ml</tt></a> provided. Add your
      <span style="text-decoration:underline;">name</span>, your <span style="text-decoration:underline;">email address</span>, and any <span style="text-decoration:underline;">remarks</span> that you
      wish to make to the instructor to the block comment at the head of the file.</p></li>

      <li><p><b>Please do not change the types in the signature of the
	function stubs I provide</b>. Doing so will make it
	impossible to load your code into the testing infrastructure,
	and make me unhappy.</p></li>

      <li><p>Feel free to define helper functions if you need them.</p></li>
    </ul>


    <hr>

    
    <p class="subtitle">Electronic submission instructions:</p>

    <ul>
      <li><p>Start a <i>new</i> OCaml shell.</p></li>
      <li><p>Load your homework code via <tt>#use "homework4.ml";;</tt></p></li>
      <li><p>If there are any error, do not submit. I can't test what I
	can't <tt>#use</tt>.</p></li>
      <li><p>When you're ready to submit, send an email with your file <tt>homework4.ml</tt> as an attachment to <tt>olin.submissions@gmail.com</tt> with subject <i>Homework 4 submission</i>.</p></li>
    </ul>


    <hr>

    <p>Consider the following type for finite automata:</p>
    <pre>
   type 'a fa = { states: 'a list;
                  alphabet: char list;
                  delta: ('a * char * 'a) list;
                  start : 'a;
                  final : 'a list }
</pre>
<p>A finite automaton  is described by a record with fields holding the various
components of the automaton: the set of states, the alphabet, the
transition relation &Delta;, the start state, and the set of final states. Lists are  
used to represent sets. The transition relation is represented using
  list of triples (<i>p</i>,<i>a</i>,<i>q</i>), stating that in
  state <i>p</i>, reading symbol 
  <i>a</i> makes the machine transition to state <i>q</i>. The automaton itself is
parameterized over the type of states. (That means that you can use
               strings, or integers, or anything you want to represent
               states.)  
</p>

<p>Records are basically dictionaries, except that they are statically
    typed, and the field names making up a record are part of its
    type. For information how to work with records in
    OCaml, <a href="http://www.cs.cornell.edu/courses/cs3110/2011sp/recitations/rec02-ocaml/ocaml.htm">check
    out this 
    link</a> and scroll down to the <i>Records</i> section. Note that
    aside from pattern matching, you can also access the fields of a
  record using the <tt>.</tt> notation: <tt>record.fld</tt> will
  return the value of field <tt>fld</tt> of <tt>record</tt>.
</p>

<p>Here is an example of a finite automaton that accepts the
  language of all strings over <tt>{a,b,c}</tt> whose last three
  symbols are <tt>b</tt>s. The states are integers.
</p>

<pre>
   let faLastThreeB = {
     states = [0;1;2;3];
     alphabet = ['a';'b';'c'];
     delta = [ (0,'a',0);
               (0,'b',0);
               (0,'c',0);
               (0,'b',1);
               (1,'b',2);
               (2,'b',3); ];
     start = 0;
     final = [3]
   } 
</pre>

<p>Here is an example of a (deterministic) finite automaton that accepts
  the set of all strings over <tt>{a,b}</tt> that contains a number
  of <tt>a</tt>s that is a multiple of 3.  For variety, the states are strings.
</p>

<pre>
   let faThreeA = { 
     states = ["start";"one";"two"];
     alphabet = ['a';'b'];
     delta = [ ("start",'a',"one");
               ("one",'a',"two");
               ("two",'a',"start");
               ("start",'b',"start");
               ("one",'b',"one");
               ("two",'b',"two") ];
     start = "start";
     final = ["start"]
   } 
</pre>

    <hr>

    <ol class="question">
      <li> <p><b>Finite Automata</b></p>

	<ol class="subquestion">

	  <li><p>
	      Code a function <tt class="code">hasFinal</tt> of
	    type <tt class="code">'a fa -> 'a list -> bool</tt>
	    where <tt>hasFinal m qs</tt> returns true if one of the
	      states in <tt>qs</tt> is a final state of
	      automaton <tt>m</tt>, and false
	    otherwise. </p>

<div class="code">
  <p onClick="toggleShowHide(this)">Show sample output</p>
  <pre>
# hasFinal faLastThreeB [];;
- : bool = false
# hasFinal faLastThreeB [0];;
- : bool = false
# hasFinal faLastThreeB [0;1];;
- : bool = false
# hasFinal faLastThreeB [0;1;2];;
- : bool = false
# hasFinal faLastThreeB [0;1;2;3];;
- : bool = true
# hasFinal faLastThreeB [3];;
- : bool = true
# hasFinal faThreeA ["start";"one"];;
- : bool = true
</pre>
</div>
	  </li>


	  <li><p>
	      Code a function <tt class="code">reachableStates</tt> of
	    type <tt class="code">'a fa -> 'a -> char -> 'a list</tt>
	    where <tt>reachableStates m q a</tt> returns the list of
	      states of <tt>m</tt> that can be reached by a transition 
	      labeled <tt>a</tt> from state <tt>q</tt>.</p>

<div class="code">
  <p onClick="toggleShowHide(this)">Show sample output</p>
  <pre>
# reachableStates faLastThreeB 0 'a';;
- : int list = [0]
# reachableStates faLastThreeB 0 'b';;
- : int list = [0; 1]
# reachableStates faLastThreeB 1 'a';;
- : int list = []
# reachableStates faLastThreeB 1 'b';;
- : int list = [2]
# reachableStates faLastThreeB 2 'a';;
- : int list = []
# reachableStates faLastThreeB 2 'b';;
- : int list = [3]
# reachableStates faLastThreeB 3 'a';;
- : int list = []
# reachableStates faLastThreeB 3 'b';;
- : int list = []
# reachableStates faThreeA "start" 'a';;
- : string list = ["one"]
</pre>
	  </div>
	  </li>


	  <li><p>
	      Code a function <tt class="code">follow</tt> of
	    type <tt class="code">'a fa -> 'a list -> char -> 'a list</tt>
	    where <tt>follow m qs a</tt> returns the list of
	      states of <tt>m</tt> that are reachable by following a transition 
	      labeled <tt>a</tt> from any of the states
	      in <tt>qs</tt>.</p>

	    <p>(For your own sanity, you should make
	      sure that the resulting list has no duplicate
	      states. Execution of later functions may slow to a
	      crawl otherwise. The easiest way to do so is to
	      implement a function that adds states to an existing list
	      of states but making sure that it only adds a state if
	      it isn't already in the list.)</p>

<div class="code">
  <p onClick="toggleShowHide(this)">Show sample output</p>
  <pre>
# follow faThreeA [] 'a';;
- : string list = []
# follow faThreeA ["start"] 'a';;
- : string list = ["one"]
# follow faThreeA ["start"] 'b';;
- : string list = ["start"]
# follow faThreeA ["start"; "one"] 'a';;
- : string list = ["one"; "two"]
# follow faThreeA ["start"; "one"] 'b';;
- : string list = ["start"; "one"]
# follow faLastThreeB [0;1] 'a';;
- : int list = [0]
# follow faLastThreeB [0;1] 'b';;
- : int list = [0; 1; 2]
</pre>
	  </div>	  </li>


	  <li><p>
	      Code a function <tt class="code">followAll</tt> of
	    type <tt class="code">'a fa -> 'a list -> char list -> 'a list</tt>
	    where <tt>followAll m qs as</tt> returns the list of
	      states of <tt>m</tt> that are reachable by following a
	      sequence of transitions labeled by the symbols
	      in <tt>as</tt> (in order) starting from any of the states
	      in <tt>qs</tt>.</p>

	    <p>(Again, for your own sanity, you should make
	      sure that the resulting list has no duplicate
	      states.)</p>

<div class="code">
  <p onClick="toggleShowHide(this)">Show sample output</p>
  <pre>
# followAll faThreeA [] [];;
- : string list = []
# followAll faThreeA [] ['a'];;
- : string list = []
# followAll faThreeA [] ['a';'b'];;
- : string list = []
# followAll faThreeA ["start"] [];;
- : string list = ["start"]
# followAll faThreeA ["start"] ['a'];;
- : string list = ["one"]
# followAll faThreeA ["start"] ['a';'b'];;
- : string list = ["one"]
# followAll faThreeA ["start"] ['a';'a'];;
- : string list = ["two"]
# followAll faThreeA ["start";"one"] ['a';'a'];;
- : string list = ["two"; "start"]
# followAll faThreeA ["start";"one"] ['a';'a';'b'];;
- : string list = ["two"; "start"]
# followAll faThreeA ["start";"one"] ['a';'a';'b';'a'];;
- : string list = ["start"; "one"]
# followAll faLastThreeB [0;1] ['a';'b';'b';'b'];;
- : int list = [0; 1; 2; 3]
</pre>
	  </div>	  </li>


	  <li><p>
	      Code a function <tt class="code">accept</tt> of
	    type <tt class="code">'a fa -> string -> bool</tt>
	    where <tt>accept m s</tt> returns true if and only if
	      finite automaton <tt>m</tt> accepts the
	      string <tt>s</tt>. That is, it returns true exactly if
	      there is a way to follow the transitions of <tt>m</tt>
	      labeled by the symbols in <tt>s</tt>
	      from the start state to a final state.</p>

	    <p>You can use function <tt>explode</tt> (provided in the homework
	    code) to turn a string into a list of characters. You
	      should probably also use <tt>followAll</tt>...</p>

	    <p>For testing purposes, I've provided you with a function <tt>lang</tt>
	      where <tt>lang m k</tt> prints out all the strings of length up to <tt>k</tt>
	      accepted by finite automaton <tt>m</tt>. Note that it calls 
	      <tt>accept</tt>, so it won't work correctly until you
	      implement that function. </p>

<div class="code">
  <p onClick="toggleShowHide(this)">Show sample output</p>
  <pre>
# accept faThreeA "babab";;
- : bool = false
# accept faThreeA "bababa";;
- : bool = true
# accept faThreeA "bababab";;
- : bool = true
# accept faLastThreeB "abb";;
- : bool = false
# accept faLastThreeB "abbb";;
- : bool = true
# accept faLastThreeB "abbbb";;
- : bool = true
# lang faLastThreeB 6;;
  bbb
  abbb
  bbbb
  cbbb
  aabbb
  babbb
  cabbb
  abbbb
  bbbbb
  cbbbb
  acbbb
  bcbbb
  ccbbb
  aaabbb
  baabbb
  caabbb
  ababbb
  bbabbb
  cbabbb
  acabbb
  bcabbb
  ccabbb
  aabbbb
  babbbb
  cabbbb
  abbbbb
  bbbbbb
  cbbbbb
  acbbbb
  bcbbbb
  ccbbbb
  aacbbb
  bacbbb
  cacbbb
  abcbbb
  bbcbbb
  cbcbbb
  accbbb
  bccbbb
  cccbbb
</pre>
</div>
	  </li>


	</ol>

      </li>



      <li> <p><b>Designing Finite Automata</b></p>

        <p>In this question, I will ask you to come up with finite
	  automata. You can test your automata
	  with the code you wrote in Question 1. </p>

	<p>For submission purposes, I ask you to define those finite
	  automata as constants using <tt>let</tt> with a fixed
	  name given below in each question. There is already a
	  placeholder in <tt>homework4.ml</tt> for those answers. Just
	  replace the placeholder with your definition.</p>

	<ol class="subquestion">

	  <li><p>
	      Design a finite automaton <tt class="code">fa_q2_a</tt> for
	      the language consisting of all strings over the alphabet
	      <tt>{a,b,c}</tt> of length at least four where the fourth
	      symbol from the end is a <tt>c</tt>.
	    </p>

<div class="code">
  <p onClick="toggleShowHide(this)">Show sample output</p>
  <pre>
# lang fa_q2_a 6;;
  caaa
  cbaa
  ccaa
  caba
  cbba
  ccba
  caca
  cbca
  ccca
  caab
  cbab
  ccab
  cabb
  cbbb
  ccbb
  cacb
  cbcb
  cccb
  caac
  cbac
  ccac
  cabc
  cbbc
  ccbc
  cacc
  cbcc
  cccc
  acaaa
  bcaaa
  ccaaa
  acbaa
  bcbaa
  ccbaa
  accaa
  bccaa
  cccaa
  acaba
  bcaba
  ccaba
  acbba
  bcbba
  ccbba
  accba
  bccba
  cccba
  acaca
  bcaca
  ccaca
  acbca
  bcbca
  ccbca
  accca
  bccca
  cccca
  acaab
  bcaab
  ccaab
  acbab
  bcbab
  ccbab
  accab
  bccab
  cccab
  acabb
  bcabb
  ccabb
  acbbb
  bcbbb
  ccbbb
  accbb
  bccbb
  cccbb
  acacb
  bcacb
  ccacb
  acbcb
  bcbcb
  ccbcb
  acccb
  bcccb
  ccccb
  acaac
  bcaac
  ccaac
  acbac
  bcbac
  ccbac
  accac
  bccac
  cccac
  acabc
  bcabc
  ccabc
  acbbc
  bcbbc
  ccbbc
  accbc
  bccbc
  cccbc
  acacc
  bcacc
  ccacc
  acbcc
  bcbcc
  ccbcc
  acccc
  bcccc
  ccccc
  aacaaa
  bacaaa
  cacaaa
  abcaaa
  bbcaaa
  cbcaaa
  accaaa
  bccaaa
  cccaaa
  aacbaa
  bacbaa
  cacbaa
  abcbaa
  bbcbaa
  cbcbaa
  accbaa
  bccbaa
  cccbaa
  aaccaa
  baccaa
  caccaa
  abccaa
  bbccaa
  cbccaa
  acccaa
  bcccaa
  ccccaa
  aacaba
  bacaba
  cacaba
  abcaba
  bbcaba
  cbcaba
  accaba
  bccaba
  cccaba
  aacbba
  bacbba
  cacbba
  abcbba
  bbcbba
  cbcbba
  accbba
  bccbba
  cccbba
  aaccba
  baccba
  caccba
  abccba
  bbccba
  cbccba
  acccba
  bcccba
  ccccba
  aacaca
  bacaca
  cacaca
  abcaca
  bbcaca
  cbcaca
  accaca
  bccaca
  cccaca
  aacbca
  bacbca
  cacbca
  abcbca
  bbcbca
  cbcbca
  accbca
  bccbca
  cccbca
  aaccca
  baccca
  caccca
  abccca
  bbccca
  cbccca
  acccca
  bcccca
  ccccca
  aacaab
  bacaab
  cacaab
  abcaab
  bbcaab
  cbcaab
  accaab
  bccaab
  cccaab
  aacbab
  bacbab
  cacbab
  abcbab
  bbcbab
  cbcbab
  accbab
  bccbab
  cccbab
  aaccab
  baccab
  caccab
  abccab
  bbccab
  cbccab
  acccab
  bcccab
  ccccab
  aacabb
  bacabb
  cacabb
  abcabb
  bbcabb
  cbcabb
  accabb
  bccabb
  cccabb
  aacbbb
  bacbbb
  cacbbb
  abcbbb
  bbcbbb
  cbcbbb
  accbbb
  bccbbb
  cccbbb
  aaccbb
  baccbb
  caccbb
  abccbb
  bbccbb
  cbccbb
  acccbb
  bcccbb
  ccccbb
  aacacb
  bacacb
  cacacb
  abcacb
  bbcacb
  cbcacb
  accacb
  bccacb
  cccacb
  aacbcb
  bacbcb
  cacbcb
  abcbcb
  bbcbcb
  cbcbcb
  accbcb
  bccbcb
  cccbcb
  aacccb
  bacccb
  cacccb
  abcccb
  bbcccb
  cbcccb
  accccb
  bccccb
  cccccb
  aacaac
  bacaac
  cacaac
  abcaac
  bbcaac
  cbcaac
  accaac
  bccaac
  cccaac
  aacbac
  bacbac
  cacbac
  abcbac
  bbcbac
  cbcbac
  accbac
  bccbac
  cccbac
  aaccac
  baccac
  caccac
  abccac
  bbccac
  cbccac
  acccac
  bcccac
  ccccac
  aacabc
  bacabc
  cacabc
  abcabc
  bbcabc
  cbcabc
  accabc
  bccabc
  cccabc
  aacbbc
  bacbbc
  cacbbc
  abcbbc
  bbcbbc
  cbcbbc
  accbbc
  bccbbc
  cccbbc
  aaccbc
  baccbc
  caccbc
  abccbc
  bbccbc
  cbccbc
  acccbc
  bcccbc
  ccccbc
  aacacc
  bacacc
  cacacc
  abcacc
  bbcacc
  cbcacc
  accacc
  bccacc
  cccacc
  aacbcc
  bacbcc
  cacbcc
  abcbcc
  bbcbcc
  cbcbcc
  accbcc
  bccbcc
  cccbcc
  aacccc
  bacccc
  cacccc
  abcccc
  bbcccc
  cbcccc
  accccc
  bccccc
  cccccc
- : unit = ()
</pre>
	  </div>
	  </li>


	  <li><p>
	      Design a finite automaton
	      <tt class="code">fa_q2_b</tt> for
	      the language consisting of all strings over the
	      alphabet <tt>{a,b,c}</tt> in which there are no sequences of four <tt>a</tt> in a row.
	    </p>

<div class="code">
  <p onClick="toggleShowHide(this)">Show sample output</p>
  <pre>
# lang fa_q2_b 5;;
  &lt;epsilon&gt;
  a
  b
  c
  aa
  ba
  ca
  ab
  bb
  cb
  ac
  bc
  cc
  aaa
  baa
  caa
  aba
  bba
  cba
  aca
  bca
  cca
  aab
  bab
  cab
  abb
  bbb
  cbb
  acb
  bcb
  ccb
  aac
  bac
  cac
  abc
  bbc
  cbc
  acc
  bcc
  ccc
  baaa
  caaa
  abaa
  bbaa
  cbaa
  acaa
  bcaa
  ccaa
  aaba
  baba
  caba
  abba
  bbba
  cbba
  acba
  bcba
  ccba
  aaca
  baca
  caca
  abca
  bbca
  cbca
  acca
  bcca
  ccca
  aaab
  baab
  caab
  abab
  bbab
  cbab
  acab
  bcab
  ccab
  aabb
  babb
  cabb
  abbb
  bbbb
  cbbb
  acbb
  bcbb
  ccbb
  aacb
  bacb
  cacb
  abcb
  bbcb
  cbcb
  accb
  bccb
  cccb
  aaac
  baac
  caac
  abac
  bbac
  cbac
  acac
  bcac
  ccac
  aabc
  babc
  cabc
  abbc
  bbbc
  cbbc
  acbc
  bcbc
  ccbc
  aacc
  bacc
  cacc
  abcc
  bbcc
  cbcc
  accc
  bccc
  cccc
  abaaa
  bbaaa
  cbaaa
  acaaa
  bcaaa
  ccaaa
  aabaa
  babaa
  cabaa
  abbaa
  bbbaa
  cbbaa
  acbaa
  bcbaa
  ccbaa
  aacaa
  bacaa
  cacaa
  abcaa
  bbcaa
  cbcaa
  accaa
  bccaa
  cccaa
  aaaba
  baaba
  caaba
  ababa
  bbaba
  cbaba
  acaba
  bcaba
  ccaba
  aabba
  babba
  cabba
  abbba
  bbbba
  cbbba
  acbba
  bcbba
  ccbba
  aacba
  bacba
  cacba
  abcba
  bbcba
  cbcba
  accba
  bccba
  cccba
  aaaca
  baaca
  caaca
  abaca
  bbaca
  cbaca
  acaca
  bcaca
  ccaca
  aabca
  babca
  cabca
  abbca
  bbbca
  cbbca
  acbca
  bcbca
  ccbca
  aacca
  bacca
  cacca
  abcca
  bbcca
  cbcca
  accca
  bccca
  cccca
  baaab
  caaab
  abaab
  bbaab
  cbaab
  acaab
  bcaab
  ccaab
  aabab
  babab
  cabab
  abbab
  bbbab
  cbbab
  acbab
  bcbab
  ccbab
  aacab
  bacab
  cacab
  abcab
  bbcab
  cbcab
  accab
  bccab
  cccab
  aaabb
  baabb
  caabb
  ababb
  bbabb
  cbabb
  acabb
  bcabb
  ccabb
  aabbb
  babbb
  cabbb
  abbbb
  bbbbb
  cbbbb
  acbbb
  bcbbb
  ccbbb
  aacbb
  bacbb
  cacbb
  abcbb
  bbcbb
  cbcbb
  accbb
  bccbb
  cccbb
  aaacb
  baacb
  caacb
  abacb
  bbacb
  cbacb
  acacb
  bcacb
  ccacb
  aabcb
  babcb
  cabcb
  abbcb
  bbbcb
  cbbcb
  acbcb
  bcbcb
  ccbcb
  aaccb
  baccb
  caccb
  abccb
  bbccb
  cbccb
  acccb
  bcccb
  ccccb
  baaac
  caaac
  abaac
  bbaac
  cbaac
  acaac
  bcaac
  ccaac
  aabac
  babac
  cabac
  abbac
  bbbac
  cbbac
  acbac
  bcbac
  ccbac
  aacac
  bacac
  cacac
  abcac
  bbcac
  cbcac
  accac
  bccac
  cccac
  aaabc
  baabc
  caabc
  ababc
  bbabc
  cbabc
  acabc
  bcabc
  ccabc
  aabbc
  babbc
  cabbc
  abbbc
  bbbbc
  cbbbc
  acbbc
  bcbbc
  ccbbc
  aacbc
  bacbc
  cacbc
  abcbc
  bbcbc
  cbcbc
  accbc
  bccbc
  cccbc
  aaacc
  baacc
  caacc
  abacc
  bbacc
  cbacc
  acacc
  bcacc
  ccacc
  aabcc
  babcc
  cabcc
  abbcc
  bbbcc
  cbbcc
  acbcc
  bcbcc
  ccbcc
  aaccc
  baccc
  caccc
  abccc
  bbccc
  cbccc
  acccc
  bcccc
  ccccc
- : unit = ()
</pre>
	  </div>
	  </li>


	  <li><p>
	      Design a finite automaton
	      <tt class="code">fa_q2_c</tt> for
	      the language consisting of all strings over the alphabet
	      <tt>{a,b,c}</tt> subject to the constraint that <tt>b</tt> is the only symbol that can 
	      follow an <tt>a</tt>, and <tt>c</tt> is the only symbol that can follow a <tt>b</tt>. 
	    </p>

<div class="code">
  <p onClick="toggleShowHide(this)">Show sample output</p>
  <pre>
# lang fa_q2_c 6;;
  &lt;epsilon>
  a
  b
  c
  ca
  ab
  cb
  bc
  cc
  bca
  cca
  cab
  bcb
  ccb
  abc
  cbc
  bcc
  ccc
  abca
  cbca
  bcca
  ccca
  bcab
  ccab
  abcb
  cbcb
  bccb
  cccb
  cabc
  bcbc
  ccbc
  abcc
  cbcc
  bccc
  cccc
  cabca
  bcbca
  ccbca
  abcca
  cbcca
  bccca
  cccca
  abcab
  cbcab
  bccab
  cccab
  cabcb
  bcbcb
  ccbcb
  abccb
  cbccb
  bcccb
  ccccb
  bcabc
  ccabc
  abcbc
  cbcbc
  bccbc
  cccbc
  cabcc
  bcbcc
  ccbcc
  abccc
  cbccc
  bcccc
  ccccc
  bcabca
  ccabca
  abcbca
  cbcbca
  bccbca
  cccbca
  cabcca
  bcbcca
  ccbcca
  abccca
  cbccca
  bcccca
  ccccca
  cabcab
  bcbcab
  ccbcab
  abccab
  cbccab
  bcccab
  ccccab
  bcabcb
  ccabcb
  abcbcb
  cbcbcb
  bccbcb
  cccbcb
  cabccb
  bcbccb
  ccbccb
  abcccb
  cbcccb
  bccccb
  cccccb
  abcabc
  cbcabc
  bccabc
  cccabc
  cabcbc
  bcbcbc
  ccbcbc
  abccbc
  cbccbc
  bcccbc
  ccccbc
  bcabcc
  ccabcc
  abcbcc
  cbcbcc
  bccbcc
  cccbcc
  cabccc
  bcbccc
  ccbccc
  abcccc
  cbcccc
  bccccc
  cccccc
- : unit = ()
</pre>
	  </div>
	  </li>


	  <li><p>
	      Design a finite automaton
	      <tt class="code">fa_q2_d</tt> for
	      the language consisting of all strings over the alphabet
	      <tt>{a,b,c}</tt> in which there are an odd number
	      of <tt>a</tt>, an even number of <tt>b</tt>, and any number of <tt>c</tt>.
	    </p>

<div class="code">
  <p onClick="toggleShowHide(this)">Show sample output</p>
  <pre>
# lang fa_q2_d 6;;
  a
  ca
  ac
  aaa
  bba
  cca
  bab
  abb
  cac
  acc
  caaa
  acaa
  cbba
  bcba
  aaca
  bbca
  ccca
  cbab
  bcab
  cabb
  acbb
  bacb
  abcb
  aaac
  bbac
  ccac
  babc
  abbc
  cacc
  accc
  aaaaa
  bbaaa
  ccaaa
  babaa
  abbaa
  cacaa
  accaa
  baaba
  ababa
  aabba
  bbbba
  ccbba
  cbcba
  bccba
  caaca
  acaca
  cbbca
  bcbca
  aacca
  bbcca
  cccca
  baaab
  abaab
  aabab
  bbbab
  ccbab
  cbcab
  bccab
  aaabb
  bbabb
  ccabb
  babbb
  abbbb
  cacbb
  accbb
  cbacb
  bcacb
  cabcb
  acbcb
  baccb
  abccb
  caaac
  acaac
  cbbac
  bcbac
  aacac
  bbcac
  cccac
  cbabc
  bcabc
  cabbc
  acbbc
  bacbc
  abcbc
  aaacc
  bbacc
  ccacc
  babcc
  abbcc
  caccc
  acccc
  caaaaa
  acaaaa
  cbbaaa
  bcbaaa
  aacaaa
  bbcaaa
  cccaaa
  cbabaa
  bcabaa
  cabbaa
  acbbaa
  bacbaa
  abcbaa
  aaacaa
  bbacaa
  ccacaa
  babcaa
  abbcaa
  caccaa
  acccaa
  cbaaba
  bcaaba
  cababa
  acbaba
  bacaba
  abcaba
  caabba
  acabba
  cbbbba
  bcbbba
  aacbba
  bbcbba
  cccbba
  baacba
  abacba
  aabcba
  bbbcba
  ccbcba
  cbccba
  bcccba
  aaaaca
  bbaaca
  ccaaca
  babaca
  abbaca
  cacaca
  accaca
  baabca
  ababca
  aabbca
  bbbbca
  ccbbca
  cbcbca
  bccbca
  caacca
  acacca
  cbbcca
  bcbcca
  aaccca
  bbccca
  ccccca
  cbaaab
  bcaaab
  cabaab
  acbaab
  bacaab
  abcaab
  caabab
  acabab
  cbbbab
  bcbbab
  aacbab
  bbcbab
  cccbab
  baacab
  abacab
  aabcab
  bbbcab
  ccbcab
  cbccab
  bcccab
  caaabb
  acaabb
  cbbabb
  bcbabb
  aacabb
  bbcabb
  cccabb
  cbabbb
  bcabbb
  cabbbb
  acbbbb
  bacbbb
  abcbbb
  aaacbb
  bbacbb
  ccacbb
  babcbb
  abbcbb
  caccbb
  acccbb
  baaacb
  abaacb
  aabacb
  bbbacb
  ccbacb
  cbcacb
  bccacb
  aaabcb
  bbabcb
  ccabcb
  babbcb
  abbbcb
  cacbcb
  accbcb
  cbaccb
  bcaccb
  cabccb
  acbccb
  bacccb
  abcccb
  aaaaac
  bbaaac
  ccaaac
  babaac
  abbaac
  cacaac
  accaac
  baabac
  ababac
  aabbac
  bbbbac
  ccbbac
  cbcbac
  bccbac
  caacac
  acacac
  cbbcac
  bcbcac
  aaccac
  bbccac
  ccccac
  baaabc
  abaabc
  aababc
  bbbabc
  ccbabc
  cbcabc
  bccabc
  aaabbc
  bbabbc
  ccabbc
  babbbc
  abbbbc
  cacbbc
  accbbc
  cbacbc
  bcacbc
  cabcbc
  acbcbc
  baccbc
  abccbc
  caaacc
  acaacc
  cbbacc
  bcbacc
  aacacc
  bbcacc
  cccacc
  cbabcc
  bcabcc
  cabbcc
  acbbcc
  bacbcc
  abcbcc
  aaaccc
  bbaccc
  ccaccc
  babccc
  abbccc
  cacccc
  accccc
- : unit = ()
</pre>
	  </div>
	  </li>


	  <li><p>
	      Design a finite automaton <tt class="code">fa_q2_e</tt> for
	      the language consisting of all strings over the alphabet
	      <tt>{a,b,c}</tt> in which there are an odd number
	      of <tt>a</tt>, an odd number of <tt>b</tt>, and
	      exactly one <tt>c</tt>. 
	    </p>

<div class="code">
  <p onClick="toggleShowHide(this)">Show sample output</p>
  <pre>
# lang fa_q2_e 7;;
  cba
  bca
  cab
  acb
  bac
  abc
  cbaaa
  bcaaa
  cabaa
  acbaa
  bacaa
  abcaa
  caaba
  acaba
  cbbba
  bcbba
  aacba
  bbcba
  baaca
  abaca
  aabca
  bbbca
  caaab
  acaab
  cbbab
  bcbab
  aacab
  bbcab
  cbabb
  bcabb
  cabbb
  acbbb
  bacbb
  abcbb
  aaacb
  bbacb
  babcb
  abbcb
  baaac
  abaac
  aabac
  bbbac
  aaabc
  bbabc
  babbc
  abbbc
  cbaaaaa
  bcaaaaa
  cabaaaa
  acbaaaa
  bacaaaa
  abcaaaa
  caabaaa
  acabaaa
  cbbbaaa
  bcbbaaa
  aacbaaa
  bbcbaaa
  baacaaa
  abacaaa
  aabcaaa
  bbbcaaa
  caaabaa
  acaabaa
  cbbabaa
  bcbabaa
  aacabaa
  bbcabaa
  cbabbaa
  bcabbaa
  cabbbaa
  acbbbaa
  bacbbaa
  abcbbaa
  aaacbaa
  bbacbaa
  babcbaa
  abbcbaa
  baaacaa
  abaacaa
  aabacaa
  bbbacaa
  aaabcaa
  bbabcaa
  babbcaa
  abbbcaa
  caaaaba
  acaaaba
  cbbaaba
  bcbaaba
  aacaaba
  bbcaaba
  cbababa
  bcababa
  cabbaba
  acbbaba
  bacbaba
  abcbaba
  aaacaba
  bbacaba
  babcaba
  abbcaba
  cbaabba
  bcaabba
  cababba
  acbabba
  bacabba
  abcabba
  caabbba
  acabbba
  cbbbbba
  bcbbbba
  aacbbba
  bbcbbba
  baacbba
  abacbba
  aabcbba
  bbbcbba
  aaaacba
  bbaacba
  babacba
  abbacba
  baabcba
  ababcba
  aabbcba
  bbbbcba
  baaaaca
  abaaaca
  aabaaca
  bbbaaca
  aaabaca
  bbabaca
  babbaca
  abbbaca
  aaaabca
  bbaabca
  bababca
  abbabca
  baabbca
  ababbca
  aabbbca
  bbbbbca
  caaaaab
  acaaaab
  cbbaaab
  bcbaaab
  aacaaab
  bbcaaab
  cbabaab
  bcabaab
  cabbaab
  acbbaab
  bacbaab
  abcbaab
  aaacaab
  bbacaab
  babcaab
  abbcaab
  cbaabab
  bcaabab
  cababab
  acbabab
  bacabab
  abcabab
  caabbab
  acabbab
  cbbbbab
  bcbbbab
  aacbbab
  bbcbbab
  baacbab
  abacbab
  aabcbab
  bbbcbab
  aaaacab
  bbaacab
  babacab
  abbacab
  baabcab
  ababcab
  aabbcab
  bbbbcab
  cbaaabb
  bcaaabb
  cabaabb
  acbaabb
  bacaabb
  abcaabb
  caababb
  acababb
  cbbbabb
  bcbbabb
  aacbabb
  bbcbabb
  baacabb
  abacabb
  aabcabb
  bbbcabb
  caaabbb
  acaabbb
  cbbabbb
  bcbabbb
  aacabbb
  bbcabbb
  cbabbbb
  bcabbbb
  cabbbbb
  acbbbbb
  bacbbbb
  abcbbbb
  aaacbbb
  bbacbbb
  babcbbb
  abbcbbb
  baaacbb
  abaacbb
  aabacbb
  bbbacbb
  aaabcbb
  bbabcbb
  babbcbb
  abbbcbb
  aaaaacb
  bbaaacb
  babaacb
  abbaacb
  baabacb
  ababacb
  aabbacb
  bbbbacb
  baaabcb
  abaabcb
  aababcb
  bbbabcb
  aaabbcb
  bbabbcb
  babbbcb
  abbbbcb
  baaaaac
  abaaaac
  aabaaac
  bbbaaac
  aaabaac
  bbabaac
  babbaac
  abbbaac
  aaaabac
  bbaabac
  bababac
  abbabac
  baabbac
  ababbac
  aabbbac
  bbbbbac
  aaaaabc
  bbaaabc
  babaabc
  abbaabc
  baababc
  abababc
  aabbabc
  bbbbabc
  baaabbc
  abaabbc
  aababbc
  bbbabbc
  aaabbbc
  bbabbbc
  babbbbc
  abbbbbc
- : unit = ()
</pre>
	  </div>
	  </li>



	</ol>
      </li>


      <li> <p><b>Finite Automata Constructions</b></p>

	<p>In this question, we implement some of the constructions that came up in class when we discussed how to go from regular expressions to finite automata.
	</p>

	<p>
	  The sample outputs use the following simple automata:</p>
<pre>
let fa1 = { states = ["fa1_1";"fa1_2";"fa1_3"];
	    alphabet = ['a';'b';'c'];
	    delta = [ ("fa1_1",'a',"fa1_2");
		      ("fa1_2",'a',"fa1_3");
		      ("fa1_3",'a',"fa1_1") ];
	    start = "fa1_1";
	    final = ["fa1_1"] }

let fa2 = { states = ["fa2_1";"fa2_2"];
	    alphabet = ['a';'b';'c'];
	    delta = [ ("fa2_1",'b',"fa2_2");
		      ("fa2_2",'c',"fa2_1") ];
	    start = "fa2_1";
	    final = ["fa2_1"] }
</pre>
<p>
The language of <tt>fa1</tt> is the language described by regular expression <tt>(aaa)<sup>*</sup></tt>, and the language of <tt>fa2</tt> is the language described by regular expression <tt>(bc)<sup>*</sup></tt>.</p>

	<p>You may assume that the alphabets of the machines are the same and that the set of states of different machines are different.</p>

	<p>For simplicity (and to help you add new states if new states are needed), these operations work over finite automaton where states are strings.</p>

	<ol class="subquestion">

	  <li><p>
	      Code a function <tt class="code">unionM</tt> of
	    type <tt class="code">string fa -> string fa -> string fa</tt>
	      where <tt>unionM m1 m2</tt> returns a finite automaton that accepts the union of the language accepted by <tt>m1</tt> and the language accepted by <tt>m2</tt>. </p>

	    <p><b>Hint:</b> You may benefit from a helper function that takes a state <tt>p</tt> and a state <tt>q</tt> and a set of transitions <tt>delta</tt> and returns the set of all transitions from <tt>q</tt> in which the origin <tt>q</tt> has been replaced by <tt>p</tt>. (It doesn't have to be exactly this helper function, of course.) </p>

<div class="code">
  <p onClick="toggleShowHide(this)">Show sample output</p>
  <pre>
# lang fa1 10;;
  &lt;epsilon>
  aaa
  aaaaaa
  aaaaaaaaa
- : unit = ()
# lang fa2 10;;
  &lt;epsilon>
  bc
  bcbc
  bcbcbc
  bcbcbcbc
  bcbcbcbcbc
- : unit = ()
# lang (unionM fa1 fa2) 10;;
  &lt;epsilon>
  bc
  aaa
  bcbc
  aaaaaa
  bcbcbc
  bcbcbcbc
  aaaaaaaaa
  bcbcbcbcbc
- : unit = ()
# lang (unionM fa2 fa1) 10;;
  &lt;epsilon>
  bc
  aaa
  bcbc
  aaaaaa
  bcbcbc
  bcbcbcbc
  aaaaaaaaa
  bcbcbcbcbc
- : unit = ()
</pre>
	  </div>
	  </li>

	  <li><p>
	      Code a function <tt class="code">concatM</tt> of
	    type <tt class="code">string fa -> string fa -> string fa</tt>
	    where <tt>concatM m1 m2</tt> returns the finite automaton that accepts the concatenation of the language accepted by <tt>m1</tt> and the language accepted by <tt>m2</tt>. </p>

	    <p><b>Hint:</b> You may benefit from a helper function that takes a set of states <tt>ps</tt> and a state <tt>q</tt> and a set of transitions <tt>delta</tt> and returns the set of all transitions from <tt>q</tt> in which the origin <tt>q</tt> has been replaced by some state in <tt>ps</tt>. (It doesn't have to be exactly this helper function, of course. And you may even be able to reuse the helper function from the previous question!) </p>


<div class="code">
  <p onClick="toggleShowHide(this)">Show sample output</p>
  <pre>
# lang fa1 10;;
  &lt;epsilon>
  aaa
  aaaaaa
  aaaaaaaaa
- : unit = ()
# lang fa2 10;;
  &lt;epsilon>
  bc
  bcbc
  bcbcbc
  bcbcbcbc
  bcbcbcbcbc
- : unit = ()
# lang (concatM fa1 fa2) 10;;
  &lt;epsilon>
  bc
  aaa
  bcbc
  aaabc
  aaaaaa
  bcbcbc
  aaabcbc
  aaaaaabc
  bcbcbcbc
  aaaaaaaaa
  aaabcbcbc
  aaaaaabcbc
  bcbcbcbcbc
- : unit = ()
# lang (concatM fa2 fa1) 10;;
  &lt;epsilon>
  bc
  aaa
  bcbc
  bcaaa
  aaaaaa
  bcbcbc
  bcbcaaa
  bcaaaaaa
  bcbcbcbc
  aaaaaaaaa
  bcbcbcaaa
  bcbcaaaaaa
  bcbcbcbcbc
- : unit = ()
</pre>
	  </div>
	  </li>

	</ol>
      </li>


    </ol>
	
    
    

  </body>
</html>
